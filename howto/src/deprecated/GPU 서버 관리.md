# 개요

이 문서는 [2018년 3월 30일 GPU 서버 세팅](activity/2018-03-30-GPU-서버-계정-설정.md) 이후 변경된 GPU 서버 관리 방법에 대해 설명한다.

# 계정 발급 방법
현재 계정 발급시 신청자가 스누씨 계정을 이용하는 것과 새로운 계정을 만드는 것 중 하나를 선택할 수 있다.
## 스누씨 계정 이용을 희망한 경우
1. 윈도우의 `원격 데스크톱 연결`을 사용하여 Colada(colada.snucse.org)에 접속한다.
1. `Active Directory 사용자 및 컴퓨터`를 실행한 후 `CSE\Users` 조직 구성 단위에서 해당 사용자를 찾은 후 `속성` 창을 연다.
1. `소속 그룹` 탭에서 `GPU` 그룹을 추가 해준다.
1. 이제 스누씨 계정으로 GPU 서버에 접속이 가능해지므로 메일을 통해 스누씨 계정으로 접속이 가능함을 알리면 된다.

> 참고
>
> 리눅스 사용자는 `xfreerdp`(Ubuntu) `freerdp`(Arch Linux) 패키지를 설치한 후 `xfreerdp /u:CSE\\Bacchus /v:colada.snucse.org` 명령어를 입력하여 Colada에 접속할 수 있다.

## 새로운 계정 발급을 희망한 경우
1. 스누씨 계정 이용을 희망한 경우와 마찬가지로 Colada에 접속한 후 `Active Directory 사용자 및 컴퓨터`를 연다.
1. `CSE\Users\GPU` 조직 구성 단위에 새 사용자를 추가한다.
1. 비밀번호는 임의로 설정한다. `다음 로그온시 사용자가 반드시 암호를 변경해야 함` 옵션은 리눅스 쪽에서 작동하지 않을 가능성이 높으니 체크하지 않는 것을 권장한다.
1. 사용자 속성을 연다.
1. `소속 그룹` 탭에 들어가 `GPU` 그룹을 추가하고 `GPU` 그룹을 주 그룹으로 설정한다.
1. 메일을 통해 신청자에게 비밀번호를 알려주면 된다.

# 요청받은 프로그램 설치 방법
8대의 서버에 하나하나 접속해 프로그램을 설치하기는 매우 번거로우므로 설치 스크립트를 만들고 `bdo`를 사용하여 일괄적으로 GPU 서버에서 실행한다.

`bdo` 실행시 identity 파일은 sherry의 `gpu-server-key`를 이용하고 `-g` 또는 `--gpu` 플래그를 주면 된다.

보다 자세한 `bdo`의 사용 방법은 [bdo 사용법.md](howto/bdo%20사용법.md) 문서를 통해 확인할 수 있다.

# 계정 삭제 방법
## 공통 작업
1. 작업 전 사용자들에게 메일을 보내 필요한 데이터를 미리 백업해두라고 공지한다.
1. 아래의 계정 삭제 작업을 완료한 후 GPU 서버의 `/csehome` 폴더에서 해당 사용자의 홈 디렉토리를 삭제한다. 모든 GPU 서버의 `/csehome` 폴더는 네트워크를 통해 공유되어 있으므로 8대의 GPU 서버 중 어디에서 지워도 무방하다.

## 스누씨 계정을 이용하는 경우
1. Colada(colada.snucse.org)에 접속한다.
1. `Active Directory 사용자 및 컴퓨터`를 실행한 후 `CSE\Users` 조직 구성 단위에서 해당 사용자를 찾은 후 `속성` 창을 연다.
1. `소속 그룹` 탭에서 `GPU` 그룹을 제거한다.

## 새로운 계정을 발급받은 경우
1. Colada(colada.snucse.org)에 접속한다.
1. `CSE\Users\GPU` 조직 구성 단위에서 해당 사용자를 삭제한다.

# 기타
## GPU를 사용 중인 사용자를 확인하는 방법
`nvidia-smi`를 실행하면 현재 GPU를 사용 중인 프로세스들을 확인할 수 있다. 프로세스의 PID를 확인한 후 `htop`이나 `ps` 등을 이용하여 해당 프로세스를 실행한 사용자를 확인한다.
